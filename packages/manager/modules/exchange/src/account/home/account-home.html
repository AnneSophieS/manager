<div class="row">
    <div class="col-md-9">
        <p class="text-nowrap">
            <strong data-translate="exchange_tab_INFORMATIONS_webmail"></strong>

            <a
                class="oui-link_icon"
                target="_blank"
                data-ng-href="https://{{:: $ctrl.webUrl }}"
                rel="noopener">
                https://<span data-ng-bind=":: $ctrl.webUrl"></span>
                <span class="oui-icon oui-icon-external_link" aria-hidden="true"></span>
                <span class="sr-only" data-translate="common_newtab"></span>
            </a>
        </p>

        <div
            class="alert alert-warning"
            role="alert"
            data-ng-if="!$ctrl.loading && $ctrl.accounts && $ctrl.accounts.list.messages.length > 0">
            <strong 
                class="d-block"
                data-translate="exchange_tab_ACCOUNTS_warning"></strong>
            <span data-translate="exchange_tab_ACCOUNTS_partial"></span>
        </div>

        <oui-datagrid
            data-ng-attr-id="{{:: $ctrl.bindings.accounts.id }}"
            data-on-page-change=":: $ctrl.onPageChange($pagination)"
            data-rows-loader=":: $ctrl.getAccounts()">
            <oui-column
                data-title=":: 'exchange_tab_ACCOUNTS_table_email' | translate"
                data-property="primaryEmailAddress"
                data-type="string"
                data-type-options="$ctrl.bindings.accounts.columns.primaryEmailAddress.typeOptions"
                data-searchable
                data-filterable
                data-sortable="asc"></oui-column>
            
            <oui-column
                data-title=":: 'exchange_tab_ACCOUNTS_table_type' | translate"
                data-property="accountLicense"
                data-type="options"
                data-type-options="$ctrl.bindings.accounts.columns.accountLicense.typeOptions"
                data-filterable>
                <span data-ng-bind=":: $ctrl.exchangeAccountTypes.getDisplayValue($value)"></span>
            </oui-column>

            <oui-column
                data-title=":: 'exchange_tab_ACCOUNTS_table_company' | translate"
                data-property="company"
                data-type="string"
                data-filterable></oui-column>

            <oui-column data-title=":: 'exchange_tab_ACCOUNTS_table_size' | translate">
                <exchange-account-size
                    data-used="$row.currentUsage"
                    data-total="$row.quota"></exchange-account-size>
            </oui-column>

            <oui-column
                data-title=":: 'exchange_tab_ACCOUNTS_table_alias' | translate"
                data-property="numberOfAliases"
                data-type="number"
                data-sortable></oui-column>

            <oui-column
                data-title=":: 'exchange_tab_ACCOUNTS_table_outlook' | translate"
                data-property="outlookStatus"
                data-type="string">
                <span data-ng-bind="$value.displayValue"></span>
            </oui-column>
            
            <oui-column
                data-title=":: 'exchange_tab_ACCOUNTS_table_status' | translate"
                data-property="status"
                data-type="string">
            </oui-column>
        </oui-datagrid>
    </div>
</div>
